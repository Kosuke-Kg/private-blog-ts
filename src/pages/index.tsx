import { type GetStaticProps, type NextPage } from 'next'
import Head from 'next/head'
import React from 'react'
import { ENDPOINTS, PER_PAGE } from '@/common/settings'
import Layouts from '@/components/Layouts/Layouts'
import Pagination from '@/components/Pagination'
import BlogList from '@/components/blogList/BlogList'
import SmallTitle from '@/components/title/SmallTitle'
import { client } from '@/libs/client'
import { type Blog } from '@/types/blog'

interface Props {
  blog: Blog[]
  totalCount: number
}

export const getStaticProps: GetStaticProps = async () => {
  const data = await client.get({
    endpoint: ENDPOINTS.blogs,
    queries: {
      offset: 0,
      limit: PER_PAGE,
    },
  })

  return {
    props: {
      blog: data.contents,
      totalCount: data.totalCount,
    },
  }
}
const Home: NextPage<Props> = ({ blog, totalCount }: Props) => {
  return (
    <>
      <Head>
        <title>Create Next App</title>
        <meta name='description' content='Generated by create next app' />
        <meta name='viewport' content='width=device-width, initial-scale=1' />
        <link rel='icon' href='/favicon.ico' />
      </Head>
      <Layouts>
        <>
          <SmallTitle heads='h2' title='New' />
          {totalCount > 0 ? <BlogList blog={blog} /> : <h3>記事がありません</h3>}
          <Pagination totalCount={totalCount} />
        </>
      </Layouts>
    </>
  )
}

export default Home
