import { type GetStaticProps, type NextPage } from 'next'
import Head from 'next/head'
import Link from 'next/link'
import React from 'react'
import { ENDPOINTS } from '@/common/settings'
import Pagination from '@/components/Pagination'
import { client } from '@/libs/client'
import { type Blog } from '@/types/blog'

interface Props {
  blog: Blog[]
  totalCount: number
}

export const getStaticProps: GetStaticProps = async () => {
  const data = await client.get({
    endpoint: ENDPOINTS.blogs,
    queries: {
      offset: 0,
      limit: 10,
    },
  })

  return {
    props: {
      blog: data.contents,
      totalCount: data.totalCount,
    },
  }
}
const Home: NextPage<Props> = ({ blog, totalCount }: Props) => {
  return (
    <>
      <Head>
        <title>Create Next App</title>
        <meta name='description' content='Generated by create next app' />
        <meta name='viewport' content='width=device-width, initial-scale=1' />
        <link rel='icon' href='/favicon.ico' />
      </Head>
      <main>
        {blog?.map((b: Blog) => (
          <li key={b.id}>
            <Link href={`/blog/${b.id}`}>{b.title}</Link>
          </li>
        ))}
        <Pagination totalCount={totalCount} />
      </main>
    </>
  )
}

export default Home
